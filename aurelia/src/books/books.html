<template>
  <div class="ui fluid container custom-width">

    <div class="ui grid add-book-breadcrumb">
      <div class="twelve wide column">
        <div class="ui huge breadcrumb">
          <a href="#" class="section">
            <i class="home icon"></i>
          </a>
          <i class="right chevron icon divider"></i>
          <div class="active section">
            <span>${bookTypes} books</span>
            <span if.bind="fetchingBooksFromApi" class="ui active tiny inline loader"></span>
            <span if.bind="!fetchingBooksFromApi">(${numberOfBooks})</span>
          </div>
        </div>
      </div>

      <div class="middle aligned right aligned four wide column">
        <select class="ui fluid dropdown" value.bind="selectedSortID" change.delegate="sortOrFilterParamsChanged()">
          <option repeat.for="sortID of sortIDs" model.bind="sortID.id">${sortID.string}</option>
        </select>
      </div>

      <div class="sixteen wide column all-books filters">

        <a class="ui red label" if.bind="selectedCityID!=0">
          ${cities[selectedCityID-1].string}
          <i class="delete icon" click.delegate="cityTagDeleteButtonPressed()"></i>
        </a>

        <a class="ui blue label" repeat.for="selectedGenreID of selectedGenreIDs">
          ${genres[selectedGenreID-1].string}
          <i class="delete icon" click.delegate="genresTagDeleteButtonPressed(selectedGenreID)"></i>
        </a>

        <a class="ui orange label" repeat.for="selectedConditionID of selectedConditionIDs">
          ${conditions[selectedConditionID-1].string}
          <i class="delete icon" click.delegate="conditionsTagDeleteButtonPressed(selectedConditionID)"></i>
        </a>

        <a class="ui teal label" if.bind="selectedLanguageID!=0">
          ${languages[selectedLanguageID-1].string}
          <i class="delete icon" click.delegate="languageTagDeleteButtonPressed()"></i>
        </a>
      </div>

    </div>

    <div class="ui grid add-book">
      <div class="three wide column">

        <div class="ui red segment">
          <b style="font-size: 1.15em">Your city</b>
          <select class="ui fluid search dropdown all-books sidebar-field" id="citySelector" value.bind="selectedCityID" change.delegate="sortOrFilterParamsChanged()">
            <option model.bind="0" selected>All cities</option>
            <option repeat.for="city of cities" model.bind="city.id">${city.string}</option>
          </select>
        </div>

        <div class="ui blue segment">
          <b style="font-size: 1.15em">Genres</b>
          <form class="ui form all-books sidebar-field" method="post" change.delegate="sortOrFilterParamsChanged()">
            <div class="grouped fields">
              <div class="field" repeat.for="genre of genres">

                <div class="ui checkbox">
                  <input type="checkbox" name="small" model.bind="genre.id" id="${genre.string}" checked.bind="selectedGenreIDs">
                  <label style="cursor: pointer;" for="${genre.string}">${genre.string}</label>
                </div>
              </div>
            </div>
          </form>
        </div>

        <div class="ui orange segment">
          <b style="font-size: 1.15em">Book condition</b>
          <form class="ui form all-books sidebar-field" method="post" change.delegate="sortOrFilterParamsChanged()">
            <div class="grouped fields">
              <div class="field" repeat.for="condition of conditions">
                <div class="ui checkbox">
                  <input type="checkbox" name="small" model.bind="condition.id" id="${condition.string}" checked.bind="selectedConditionIDs">
                  <label style="cursor: pointer;" for="${condition.string}">${condition.string}</label>
                </div>
              </div>
            </div>
          </form>
        </div>

        <div class="ui teal segment">
          <b style="font-size: 1.15em">Language</b>

          <select id="languageSelector" class="ui fluid search dropdown all-books sidebar-field" value.bind="selectedLanguageID" change.delegate="sortOrFilterParamsChanged()">
            <option model.bind="0" selected>All languages</option>
            <option repeat.for="language of languages" model.bind="language.id">${language.string}</option>
          </select>

        </div>
      </div>

      <div class="thirteen wide column">
        <div class="ui list">

          <div if.bind="noBooks">Here are no books yet. Yours can be the first one!</div>

          <div class="item horizontal-line" repeat.for="books of books.books">
            <div class="ui segment">
              <div class="ui grid book-listing-hover">

                <div class="four wide middle aligned center aligned column">
                  <a href="#" click.delegate="navigateToBookById(books.id)">
                    <img src='${books.imagepath}' class="image horizontal-line">
                  </a>
                </div>

                <div class="eight wide column">
                  <div class="content">
                    <a href="#" click.delegate="navigateToBookById(books.id)">
                      <h1 class="title horizontal-line">${books.title}</h1>
                    </a>
                    <div if.bind="!ifJSONAttributeIsNull(books.author)">
                      <h2 class="author horizontal-line">by ${books.author}</h2>
                    </div>
                    <p class="description horizontal-line"></p>
                    <div class="genre horizontal-line">
                      <span>${books.genreid.string}</span>
                    </div>

                    <div class="condition horizontal-line">
                      <span>${books.conditiondesc.string}</span>
                    </div>

                    <div class="price horizontal-line">
                      <span>${books.price}</span>
                      <span> â‚¬</span>
                    </div>
                  </div>
                </div>

                <div class="right aligned four wide column">
                  <div class="content seller horizontal-line">
                    <div class="title">Seller: </div>
                    <div class="name">${books.userid.full_name}</div>

                    <div class="place">${books.city.string}</div>
                    <p></p>
                    <div class="date">${convertUnixTimeStamp(books.postdate)}</div>
                  </div>
                </div>

              </div>
            </div>
          </div>

        </div>
      </div>

    </div>

  </div>

</template>
